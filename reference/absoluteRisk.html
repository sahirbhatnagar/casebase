<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Compute absolute risks using the fitted hazard function. — absoluteRisk.CompRisk • casebase</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Compute absolute risks using the fitted hazard function. — absoluteRisk.CompRisk"><meta property="og:description" content="Using the output of the function fitSmoothHazard, we can compute
absolute risks by integrating the fitted hazard function over a time period
and then converting this to an estimated survival for each individual.
Plot method for objects returned by the absoluteRisk
function. Current plot types are cumulative incidence and survival
functions."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">casebase</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.10.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/popTime.html">Population Time Plots</a>
    </li>
    <li>
      <a href="../articles/smoothHazard.html">Fitting smooth-in-time parametric hazard functions</a>
    </li>
    <li>
      <a href="../articles/plotsmoothHazard.html">Plotting Hazards and Hazard Ratios</a>
    </li>
    <li>
      <a href="../articles/plotabsRisk.html">Plot Cumulative Incidence and Survival Curves</a>
    </li>
    <li>
      <a href="../articles/competingRisk.html">Competing risk analysis using case-base sampling</a>
    </li>
    <li>
      <a href="../articles/customizingpopTime.html">Customizing Population Time Plots</a>
    </li>
    <li>
      <a href="../articles/time-varying-covariates.html">Time-Varying Covariates</a>
    </li>
  </ul></li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/sahirbhatnagar/casebase/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Compute absolute risks using the fitted hazard function.</h1>
    <small class="dont-index">Source: <a href="https://github.com/sahirbhatnagar/casebase/blob/HEAD/R/absoluteRisk-cr.R" class="external-link"><code>R/absoluteRisk-cr.R</code></a>, <a href="https://github.com/sahirbhatnagar/casebase/blob/HEAD/R/absoluteRisk.R" class="external-link"><code>R/absoluteRisk.R</code></a>, <a href="https://github.com/sahirbhatnagar/casebase/blob/HEAD/R/methods.R" class="external-link"><code>R/methods.R</code></a>, and 1 more</small>
    <div class="hidden name"><code>absoluteRisk.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Using the output of the function <code>fitSmoothHazard</code>, we can compute
absolute risks by integrating the fitted hazard function over a time period
and then converting this to an estimated survival for each individual.</p>
<p>Plot method for objects returned by the <code>absoluteRisk</code>
function. Current plot types are cumulative incidence and survival
functions.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">absoluteRisk.CompRisk</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  <span class="va">time</span>,</span>
<span>  <span class="va">newdata</span>,</span>
<span>  method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"numerical"</span>, <span class="st">"montecarlo"</span><span class="op">)</span>,</span>
<span>  nsamp <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  onlyMain <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CI"</span>, <span class="st">"survival"</span><span class="op">)</span>,</span>
<span>  addZero <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">absoluteRisk</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  <span class="va">time</span>,</span>
<span>  <span class="va">newdata</span>,</span>
<span>  method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"numerical"</span>, <span class="st">"montecarlo"</span><span class="op">)</span>,</span>
<span>  nsamp <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  s <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"lambda.1se"</span>, <span class="st">"lambda.min"</span><span class="op">)</span>,</span>
<span>  onlyMain <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CI"</span>, <span class="st">"survival"</span><span class="op">)</span>,</span>
<span>  addZero <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  ntimes <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for absRiskCB</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for absRiskCB</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  xlab <span class="op">=</span> <span class="st">"time"</span>,</span>
<span>  ylab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"type"</span><span class="op">)</span> <span class="op">==</span> <span class="st">"CI"</span>, <span class="st">"cumulative incidence"</span>, <span class="st">"survival probability"</span><span class="op">)</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"l"</span>,</span>
<span>  gg <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">id.names</span>,</span>
<span>  <span class="va">legend.title</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>object</dt>
<dd><p>Output of function <code><a href="fitSmoothHazard.html">fitSmoothHazard</a></code>.</p></dd>


<dt>time</dt>
<dd><p>A vector of time points at which we should compute the absolute
risks.</p></dd>


<dt>newdata</dt>
<dd><p>Optionally, a data frame in which to look for variables with
which to predict. If omitted, the mean absolute risk is returned.
Alternatively, if <code>newdata = "typical"</code>, the absolute risk will be
computed at a "typical" covariate profile (see Details).</p></dd>


<dt>method</dt>
<dd><p>Method used for integration. Defaults to <code>"numerical"</code>,
which uses the trapezoidal rule to integrate over all time points together.
The only other option is <code>"montecarlo"</code>, which implements Monte-Carlo
integration.</p></dd>


<dt>nsamp</dt>
<dd><p>Maximal number of subdivisions (if <code>method = "numerical"</code>)
or number of sampled points (if <code>method = "montecarlo"</code>).</p></dd>


<dt>onlyMain</dt>
<dd><p>Logical. For competing risks, should we return absolute risks
only for the main event of interest? Defaults to <code>TRUE</code>.</p></dd>


<dt>type</dt>
<dd><p>Line type. Only used if <code>gg = FALSE</code>. This argument gets passed
to <code><a href="https://rdrr.io/r/graphics/matplot.html" class="external-link">graphics::matplot()</a></code>. Default: 'l'</p></dd>


<dt>addZero</dt>
<dd><p>Logical. Should we add time = 0 at the beginning of the
output? Defaults to <code>TRUE</code>.</p></dd>


<dt>s</dt>
<dd><p>Value of the penalty parameter lambda at which predictions are
required (for class <code>cv.glmnet</code>).</p></dd>


<dt>ntimes</dt>
<dd><p>Number of time points (only used if <code>time</code> is missing).</p></dd>


<dt>...</dt>
<dd><p>further arguments passed to <code>matplot</code>. Only used if
<code>gg=FALSE</code>.</p></dd>


<dt>x</dt>
<dd><p>Fitted object of class <code>absRiskCB</code>. This is the result from the
<code>absoluteRisk()</code> function.</p></dd>


<dt>xlab</dt>
<dd><p>xaxis label, Default: 'time'</p></dd>


<dt>ylab</dt>
<dd><p>yaxis label. By default, this will use the <code>"type"</code> attribute of
the <code>absRiskCB</code> object</p></dd>


<dt>gg</dt>
<dd><p>Logical for whether the <code>ggplot2</code> package should be used for
plotting. Default: TRUE</p></dd>


<dt>id.names</dt>
<dd><p>Optional character vector used as legend key when <code>gg=TRUE</code>.
If missing, defaults to V1, V2, ...</p></dd>


<dt>legend.title</dt>
<dd><p>Optional character vector of the legend title. Only used
if <code>gg = FALSE</code>. Default is <code>'ID'</code></p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>If <code>time</code> was provided, returns the estimated absolute risk for
the user-supplied covariate profiles. This will be stored in a matrix or a
higher dimensional array, depending on the input (see details). If both
<code>time</code> and <code>newdata</code> are missing, returns the original data
with a new column containing the risk estimate at failure times.</p>


<p>A plot of the cumulative incidence or survival curve</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>If <code>newdata = "typical"</code>, we create a typical covariate profile for the
absolute risk computation. This means that we take the median for numerical
and date variables, and we take the most common level for factor variables.</p>
<p>In general, the output will include a column corresponding to the provided
time points. Some modifications of the <code>time</code> vector are done:
<code>time=0</code> is added, the time points are ordered, and duplicates are
removed. All these modifications simplify the computations and give an output
that can easily be used to plot risk curves.</p>
<p>If there is no competing risk, the output is a matrix where each column
corresponds to the several covariate profiles, and where each row corresponds
to a time point. If there are competing risks, the output will be a
3-dimensional array, with the third dimension corresponding to the different
events.</p>
<p>The numerical method should be good enough in most situation, but Monte Carlo
integration can give more accurate results when the estimated hazard function
is not smooth (e.g. when modeling with time-varying covariates).</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="https://rdrr.io/r/graphics/matplot.html" class="external-link">matplot</a></code>,
<code>absoluteRisk</code>,
<code><a href="https://rdatatable.gitlab.io/data.table/reference/as.data.table.html" class="external-link">as.data.table</a></code>, <code><a href="https://rdatatable.gitlab.io/data.table/reference/setattr.html" class="external-link">setattr</a></code>,
<code><a href="https://rdatatable.gitlab.io/data.table/reference/melt.data.table.html" class="external-link">melt.data.table</a></code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Simulate censored survival data for two outcome types</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-datatable.com" class="external-link">data.table</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">12345</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">nobs</span> <span class="op">&lt;-</span> <span class="fl">1000</span></span></span>
<span class="r-in"><span><span class="va">tlim</span> <span class="op">&lt;-</span> <span class="fl">20</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># simulation parameters</span></span></span>
<span class="r-in"><span><span class="va">b1</span> <span class="op">&lt;-</span> <span class="fl">200</span></span></span>
<span class="r-in"><span><span class="va">b2</span> <span class="op">&lt;-</span> <span class="fl">50</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># event type 0-censored, 1-event of interest, 2-competing event</span></span></span>
<span class="r-in"><span><span class="co"># t observed time/endpoint</span></span></span>
<span class="r-in"><span><span class="co"># z is a binary covariate</span></span></span>
<span class="r-in"><span><span class="va">DT</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/data.table.html" class="external-link">data.table</a></span><span class="op">(</span>z <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="va">nobs</span>, <span class="fl">1</span>, <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">DT</span><span class="op">[</span>,<span class="fu">`:=`</span> <span class="op">(</span><span class="st">"t_event"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Weibull.html" class="external-link">rweibull</a></span><span class="op">(</span><span class="va">nobs</span>, <span class="fl">1</span>, <span class="va">b1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>          <span class="st">"t_comp"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Weibull.html" class="external-link">rweibull</a></span><span class="op">(</span><span class="va">nobs</span>, <span class="fl">1</span>, <span class="va">b2</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           z   t_event      t_comp</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       &lt;int&gt;     &lt;num&gt;       &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    1:     1 510.83410   2.3923947</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    2:     1  33.98842  23.7578470</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    3:     1 997.76445  31.5864062</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    4:     1 209.28888   5.7092667</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    5:     0  75.35774  81.5124801</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ---                            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  996:     1 111.80274   0.1186062</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  997:     0 238.05336  60.3685477</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  998:     0 142.60033   3.6318489</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  999:     0 103.37601  24.5722384</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1000:     0 255.84352 113.5144522</span>
<span class="r-in"><span><span class="va">DT</span><span class="op">[</span>,<span class="fu">`:=`</span><span class="op">(</span><span class="st">"event"</span> <span class="op">=</span> <span class="fl">1</span> <span class="op">*</span> <span class="op">(</span><span class="va">t_event</span> <span class="op">&lt;</span> <span class="va">t_comp</span><span class="op">)</span> <span class="op">+</span> <span class="fl">2</span> <span class="op">*</span> <span class="op">(</span><span class="va">t_event</span> <span class="op">&gt;=</span> <span class="va">t_comp</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>         <span class="st">"time"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">pmin</a></span><span class="op">(</span><span class="va">t_event</span>, <span class="va">t_comp</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           z   t_event      t_comp event        time</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       &lt;int&gt;     &lt;num&gt;       &lt;num&gt; &lt;num&gt;       &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    1:     1 510.83410   2.3923947     2   2.3923947</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    2:     1  33.98842  23.7578470     2  23.7578470</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    3:     1 997.76445  31.5864062     2  31.5864062</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    4:     1 209.28888   5.7092667     2   5.7092667</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    5:     0  75.35774  81.5124801     1  75.3577374</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ---                                              </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  996:     1 111.80274   0.1186062     2   0.1186062</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  997:     0 238.05336  60.3685477     2  60.3685477</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  998:     0 142.60033   3.6318489     2   3.6318489</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  999:     0 103.37601  24.5722384     2  24.5722384</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1000:     0 255.84352 113.5144522     2 113.5144522</span>
<span class="r-in"><span><span class="va">DT</span><span class="op">[</span><span class="va">time</span> <span class="op">&gt;=</span> <span class="va">tlim</span>, <span class="fu">`:=`</span><span class="op">(</span><span class="st">"event"</span> <span class="op">=</span> <span class="fl">0</span>, <span class="st">"time"</span> <span class="op">=</span> <span class="va">tlim</span><span class="op">)</span><span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           z   t_event      t_comp event       time</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       &lt;int&gt;     &lt;num&gt;       &lt;num&gt; &lt;num&gt;      &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    1:     1 510.83410   2.3923947     2  2.3923947</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    2:     1  33.98842  23.7578470     0 20.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    3:     1 997.76445  31.5864062     0 20.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    4:     1 209.28888   5.7092667     2  5.7092667</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    5:     0  75.35774  81.5124801     0 20.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ---                                             </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  996:     1 111.80274   0.1186062     2  0.1186062</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  997:     0 238.05336  60.3685477     0 20.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  998:     0 142.60033   3.6318489     2  3.6318489</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  999:     0 103.37601  24.5722384     0 20.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1000:     0 255.84352 113.5144522     0 20.0000000</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">out_linear</span> <span class="op">&lt;-</span> <span class="fu"><a href="fitSmoothHazard.html">fitSmoothHazard</a></span><span class="op">(</span><span class="va">event</span> <span class="op">~</span> <span class="va">time</span> <span class="op">+</span> <span class="va">z</span>, <span class="va">DT</span>, ratio <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 'time' will be used as the time variable</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">linear_risk</span> <span class="op">&lt;-</span> <span class="fu">absoluteRisk</span><span class="op">(</span><span class="va">out_linear</span>, time <span class="op">=</span> <span class="fl">10</span>,</span></span>
<span class="r-in"><span>                            newdata <span class="op">=</span> <span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/data.table.html" class="external-link">data.table</a></span><span class="op">(</span><span class="st">"z"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Plot CI curves----</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"brcancer"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mod_cb_tvc</span> <span class="op">&lt;-</span> <span class="fu"><a href="fitSmoothHazard.html">fitSmoothHazard</a></span><span class="op">(</span><span class="va">cens</span> <span class="op">~</span> <span class="va">estrec</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">time</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>                                <span class="va">horTh</span> <span class="op">+</span></span></span>
<span class="r-in"><span>                                <span class="va">age</span> <span class="op">+</span></span></span>
<span class="r-in"><span>                                <span class="va">menostat</span> <span class="op">+</span></span></span>
<span class="r-in"><span>                                <span class="va">tsize</span> <span class="op">+</span></span></span>
<span class="r-in"><span>                                <span class="va">tgrade</span> <span class="op">+</span></span></span>
<span class="r-in"><span>                                <span class="va">pnodes</span> <span class="op">+</span></span></span>
<span class="r-in"><span>                                <span class="va">progrec</span>,</span></span>
<span class="r-in"><span>                              data <span class="op">=</span> <span class="va">brcancer</span>,</span></span>
<span class="r-in"><span>                              time <span class="op">=</span> <span class="st">"time"</span>, ratio <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">smooth_risk_brcancer</span> <span class="op">&lt;-</span> <span class="fu">absoluteRisk</span><span class="op">(</span>object <span class="op">=</span> <span class="va">mod_cb_tvc</span>,</span></span>
<span class="r-in"><span>                                     newdata <span class="op">=</span> <span class="va">brcancer</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">50</span><span class="op">)</span>,<span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">smooth_risk_brcancer</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "absRiskCB" "matrix"    "array"    </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">smooth_risk_brcancer</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="absoluteRisk-1.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by <a href="https://sahirbhatnagar.com/" class="external-link">Sahir Bhatnagar</a>, <a href="https://maxturgeon.ca/" class="external-link">Maxime Turgeon</a>, <a href="https://www.jesseislam.com/" class="external-link">Jesse Islam</a>, <a href="http://individual.utoronto.ca/osaarela/" class="external-link">Olli Saarela</a>, <a href="http://www.medicine.mcgill.ca/epidemiology/hanley/" class="external-link">James Hanley</a>.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

