<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Competing risk analysis • casebase</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Competing risk analysis">
<meta property="og:description" content="casebase">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">casebase</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.10.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/popTime.html">Population Time Plots</a>
    </li>
    <li>
      <a href="../articles/smoothHazard.html">Fitting smooth-in-time parametric hazard functions</a>
    </li>
    <li>
      <a href="../articles/plotsmoothHazard.html">Plotting Hazards and Hazard Ratios</a>
    </li>
    <li>
      <a href="../articles/plotabsRisk.html">Plot Cumulative Incidence and Survival Curves</a>
    </li>
    <li>
      <a href="../articles/competingRisk.html">Competing risk analysis using case-base sampling</a>
    </li>
    <li>
      <a href="../articles/customizingpopTime.html">Customizing Population Time Plots</a>
    </li>
    <li>
      <a href="../articles/time-varying-covariates.html">Time-Varying Covariates</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/sahirbhatnagar/casebase/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Competing risk analysis</h1>
                        <h4 data-toc-skip class="author">Maxime
Turgeon</h4>
            
            <h4 data-toc-skip class="date">2024-04-09</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/sahirbhatnagar/casebase/blob/HEAD/vignettes/competingRisk.Rmd" class="external-link"><code>vignettes/competingRisk.Rmd</code></a></small>
      <div class="hidden name"><code>competingRisk.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="data">Data<a class="anchor" aria-label="anchor" href="#data"></a>
</h2>
<p>We will use the same data that was used in Scrucca <em>et al</em>
<span class="citation">(2010)</span>. The data was downloaded from the
main author’s website; it is also available as part of this package.</p>
<!--Broken: http://www.stat.unipg.it/luca/R/ -->
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">12345</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://sahirbhatnagar.com/casebase/">casebase</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## See example usage at http://sahirbhatnagar.com/casebase/</span></span></code></pre>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">bmtcrr</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">bmtcrr</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   Sex   D   Phase Age Status Source  ftime</span></span>
<span><span class="co">## 1   M ALL Relapse  48      2  BM+PB   0.67</span></span>
<span><span class="co">## 2   F AML     CR2  23      1  BM+PB   9.50</span></span>
<span><span class="co">## 3   M ALL     CR3   7      0  BM+PB 131.77</span></span>
<span><span class="co">## 4   F ALL     CR2  26      2  BM+PB  24.03</span></span>
<span><span class="co">## 5   F ALL     CR2  36      2  BM+PB   1.47</span></span>
<span><span class="co">## 6   M ALL Relapse  17      2  BM+PB   2.23</span></span></code></pre>
<p>We will perform a competing risk analysis on data from 177 patients
who received a stem cell transplant for acute leukemia. The event of
interest in relapse, but other competing causes (e.g. transplant-related
death) need to be taken into account. We also want to take into account
the effect of several covariates such as Sex, Disease (lymphoblastic or
myeloblastic leukemia, abbreviated as ALL and AML, respectively), Phase
at transplant (Relapse, CR1, CR2, CR3), Source of stem cells (bone
marrow and peripheral blood, coded as BM+PB, or peripheral blood, coded
as PB), and Age. Below, we reproduce their Table 1:</p>
<table class="table">
<colgroup>
<col width="15%">
<col width="42%">
<col width="42%">
</colgroup>
<thead><tr class="header">
<th>Variable</th>
<th>Description</th>
<th>Statistical summary</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Sex</td>
<td>Sex</td>
<td>M=Male (100) <br> F=Female (77)</td>
</tr>
<tr class="even">
<td>D</td>
<td>Disease</td>
<td>ALL (73) <br> AML (104)</td>
</tr>
<tr class="odd">
<td>Phase</td>
<td>Phase</td>
<td>CR1 (47) <br> CR2 (45) <br> CR3 (12) <br> Relapse (73)</td>
</tr>
<tr class="even">
<td>Source</td>
<td>Type of transplant</td>
<td>BM+PB (21) <br> PB (156)</td>
</tr>
<tr class="odd">
<td>Age</td>
<td>Age of patient (years)</td>
<td>4–62 <br> 30.47 (13.04)</td>
</tr>
<tr class="even">
<td>Ftime</td>
<td>Failure time (months)</td>
<td>0.13–131.77 <br> 20.28 (30.78)</td>
</tr>
<tr class="odd">
<td>Status</td>
<td>Status indicator</td>
<td>0=censored (46) <br> 1=relapse (56) <br> 2=competing event (75)</td>
</tr>
</tbody>
</table>
<p>The statistical summary is generated differently for continuous and
categorical variables:</p>
<ul>
<li><p>For continuous variables, we are given the range, followed by the
mean and standard deviation.</p></li>
<li><p>For categorical variables, we are given the counts for each
category.</p></li>
</ul>
<p>Note that failure time can also correspond to censoring.</p>
</div>
<div class="section level2">
<h2 id="population-time-plots">Population-time plots<a class="anchor" aria-label="anchor" href="#population-time-plots"></a>
</h2>
<p>In order to try and visualize the incidence density of relapse, we
can look at a population-time plot: on the X-axis we have time, and on
the Y-axis we have the size of the risk set at a particular time point.
Failure times associated to the event of interest can then be
highlighted on the plot using red dots.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nobs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">bmtcrr</span><span class="op">)</span></span>
<span><span class="va">ftime</span> <span class="op">&lt;-</span> <span class="va">bmtcrr</span><span class="op">$</span><span class="va">ftime</span></span>
<span><span class="va">ord</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">ftime</span>, decreasing <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># We split the person-moments in four categories:</span></span>
<span><span class="co"># 1) at-risk</span></span>
<span><span class="co"># 2) main event</span></span>
<span><span class="co"># 3) competing event</span></span>
<span><span class="co"># 4) censored</span></span>
<span><span class="va">yCoords</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cumsum.html" class="external-link">cumsum</a></span><span class="op">(</span><span class="va">bmtcrr</span><span class="op">[</span><span class="va">ord</span>, <span class="st">"Status"</span><span class="op">]</span> <span class="op">==</span> <span class="fl">2</span><span class="op">)</span>, </span>
<span>                 <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html" class="external-link">cumsum</a></span><span class="op">(</span><span class="va">bmtcrr</span><span class="op">[</span><span class="va">ord</span>, <span class="st">"Status"</span><span class="op">]</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>                 <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html" class="external-link">cumsum</a></span><span class="op">(</span><span class="va">bmtcrr</span><span class="op">[</span><span class="va">ord</span>, <span class="st">"Status"</span><span class="op">]</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">yCoords</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">yCoords</span>, <span class="va">nobs</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowSums</a></span><span class="op">(</span><span class="va">yCoords</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot only at-risk</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fl">0</span>, type <span class="op">=</span> <span class="st">'n'</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">ftime</span><span class="op">)</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">nobs</span><span class="op">)</span>, </span>
<span>     xlab <span class="op">=</span> <span class="st">'Follow-up time'</span>, ylab <span class="op">=</span> <span class="st">'Population'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/polygon.html" class="external-link">polygon</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="va">ftime</span><span class="op">[</span><span class="va">ord</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">ftime</span><span class="op">)</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">nobs</span>, <span class="va">yCoords</span><span class="op">[</span>,<span class="fl">4</span><span class="op">]</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"grey90"</span><span class="op">)</span></span>
<span><span class="va">cases</span> <span class="op">&lt;-</span> <span class="va">bmtcrr</span><span class="op">[</span>, <span class="st">"Status"</span><span class="op">]</span> <span class="op">==</span> <span class="fl">1</span></span>
<span></span>
<span><span class="co"># randomly move the cases vertically</span></span>
<span><span class="va">moved_cases</span> <span class="op">&lt;-</span> <span class="va">yCoords</span><span class="op">[</span><span class="va">cases</span><span class="op">[</span><span class="va">ord</span><span class="op">]</span>, <span class="fl">4</span><span class="op">]</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">cases</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="op">(</span><span class="va">ftime</span><span class="op">[</span><span class="va">ord</span><span class="op">]</span><span class="op">)</span><span class="op">[</span><span class="va">cases</span><span class="op">[</span><span class="va">ord</span><span class="op">]</span><span class="op">]</span>, <span class="va">moved_cases</span>, pch <span class="op">=</span> <span class="fl">20</span>, </span>
<span>       col <span class="op">=</span> <span class="st">"red"</span>, cex <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="competingRisk_files/figure-html/poptime1-1.png" width="700"></p>
<p>We can right away draw a few conclusions from this plot: first of
all, we get a sense of how quickly the size of the risk set changes over
time. We also see that the incidence density is non-constant: most
relapses occur before 15 months. Finally, we also see that the risk set
keeps shrinking after the last event has occurred; this could be due to
either censoring or the competing event.</p>
<p>To get an idea of whether only relapse is responsible for the
shrinking of the risk set in the first few months of follow-up, we can
also keep track of how many events have occurred at each time point:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot at-risk and events</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fl">0</span>, type <span class="op">=</span> <span class="st">'n'</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">ftime</span><span class="op">)</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">nobs</span><span class="op">)</span>, </span>
<span>     xlab <span class="op">=</span> <span class="st">'Follow-up time'</span>, ylab <span class="op">=</span> <span class="st">'Population'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/polygon.html" class="external-link">polygon</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="va">ftime</span><span class="op">[</span><span class="va">ord</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">ftime</span><span class="op">)</span>, <span class="fl">0</span><span class="op">)</span>, </span>
<span>        y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">yCoords</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>, </span>
<span>        col <span class="op">=</span> <span class="st">"firebrick3"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/polygon.html" class="external-link">polygon</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">ftime</span><span class="op">[</span><span class="va">ord</span><span class="op">]</span>, <span class="va">ftime</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="va">ord</span><span class="op">)</span><span class="op">]</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>        y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">yCoords</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="va">yCoords</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">+</span> <span class="va">yCoords</span><span class="op">[</span>,<span class="fl">4</span><span class="op">]</span><span class="op">)</span>, <span class="va">nobs</span>, <span class="fl">0</span><span class="op">)</span>, </span>
<span>        col <span class="op">=</span> <span class="st">"grey90"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># randomly move the cases vertically</span></span>
<span><span class="va">moved_cases</span> <span class="op">&lt;-</span> <span class="va">yCoords</span><span class="op">[</span><span class="va">cases</span><span class="op">[</span><span class="va">ord</span><span class="op">]</span>, <span class="fl">2</span><span class="op">]</span> <span class="op">+</span> <span class="va">yCoords</span><span class="op">[</span><span class="va">cases</span><span class="op">[</span><span class="va">ord</span><span class="op">]</span>, <span class="fl">4</span><span class="op">]</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">cases</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="op">(</span><span class="va">ftime</span><span class="op">[</span><span class="va">ord</span><span class="op">]</span><span class="op">)</span><span class="op">[</span><span class="va">cases</span><span class="op">[</span><span class="va">ord</span><span class="op">]</span><span class="op">]</span>, <span class="va">moved_cases</span>, pch <span class="op">=</span> <span class="fl">20</span>,</span>
<span>       col <span class="op">=</span> <span class="st">"red"</span>, cex <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topright"</span>, legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Relapse"</span>, <span class="st">"At-risk"</span><span class="op">)</span>, </span>
<span>       col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"firebrick3"</span>, <span class="st">"grey90"</span><span class="op">)</span>,</span>
<span>       pch <span class="op">=</span> <span class="fl">15</span><span class="op">)</span></span></code></pre></div>
<p><img src="competingRisk_files/figure-html/poptime2-1.png" width="700"></p>
<p>Therefore, there is also censoring and loss due to competing events
happening in the first few months. However, with this plot, we can’t
differentiate between the two contributions. For this reason we can also
keep track of the number of competing events at each time point:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fl">0</span>, type <span class="op">=</span> <span class="st">'n'</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">ftime</span><span class="op">)</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">nobs</span><span class="op">)</span>, </span>
<span>     xlab <span class="op">=</span> <span class="st">'Follow-up time'</span>, ylab <span class="op">=</span> <span class="st">'Population'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/polygon.html" class="external-link">polygon</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">ftime</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">ftime</span><span class="op">)</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>        y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="va">nobs</span>, <span class="va">nobs</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span></span>
<span><span class="co"># Event of interest</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/polygon.html" class="external-link">polygon</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="va">ftime</span><span class="op">[</span><span class="va">ord</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">ftime</span><span class="op">)</span>, <span class="fl">0</span><span class="op">)</span>, </span>
<span>        y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">yCoords</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>, </span>
<span>        col <span class="op">=</span> <span class="st">"firebrick3"</span><span class="op">)</span></span>
<span><span class="co"># Risk set</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/polygon.html" class="external-link">polygon</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">ftime</span><span class="op">[</span><span class="va">ord</span><span class="op">]</span>, <span class="va">ftime</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="va">ord</span><span class="op">)</span><span class="op">]</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>        y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">yCoords</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="va">yCoords</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">+</span> <span class="va">yCoords</span><span class="op">[</span>,<span class="fl">4</span><span class="op">]</span><span class="op">)</span>, <span class="va">nobs</span>, <span class="fl">0</span><span class="op">)</span>, </span>
<span>        col <span class="op">=</span> <span class="st">"grey90"</span><span class="op">)</span></span>
<span><span class="co"># Competing event</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/polygon.html" class="external-link">polygon</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">ftime</span><span class="op">[</span><span class="va">ord</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">ftime</span><span class="op">)</span>, <span class="fl">0</span><span class="op">)</span>, </span>
<span>        y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">nobs</span>, <span class="va">nobs</span> <span class="op">-</span> <span class="va">yCoords</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, <span class="va">nobs</span>, <span class="va">nobs</span><span class="op">)</span>, </span>
<span>        col <span class="op">=</span> <span class="st">"dodgerblue2"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># randomly move the cases vertically</span></span>
<span><span class="va">moved_cases</span> <span class="op">&lt;-</span> <span class="va">yCoords</span><span class="op">[</span><span class="va">cases</span><span class="op">[</span><span class="va">ord</span><span class="op">]</span>, <span class="fl">2</span><span class="op">]</span> <span class="op">+</span> <span class="va">yCoords</span><span class="op">[</span><span class="va">cases</span><span class="op">[</span><span class="va">ord</span><span class="op">]</span>, <span class="fl">4</span><span class="op">]</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">cases</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="op">(</span><span class="va">ftime</span><span class="op">[</span><span class="va">ord</span><span class="op">]</span><span class="op">)</span><span class="op">[</span><span class="va">cases</span><span class="op">[</span><span class="va">ord</span><span class="op">]</span><span class="op">]</span>, <span class="va">moved_cases</span>, pch <span class="op">=</span> <span class="fl">20</span>,</span>
<span>       col <span class="op">=</span> <span class="st">"red"</span>, cex <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topright"</span>, legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Relapse"</span>, <span class="st">"Competing event"</span>, <span class="st">"At-risk"</span><span class="op">)</span>, </span>
<span>       col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"firebrick3"</span>, <span class="st">"dodgerblue2"</span>, <span class="st">"grey90"</span><span class="op">)</span>,</span>
<span>       pch <span class="op">=</span> <span class="fl">15</span><span class="op">)</span></span></code></pre></div>
<p><img src="competingRisk_files/figure-html/poptime3-1.png" width="700"></p>
<p>From this last plot, we can see that there is no censoring during the
first 10 months. Moreover, we see that the last competing event occurs
around 20 months. Putting all this information together, we have
evidence of two types of patients: very sick patients who either relapse
or have a competing event early on, and healthier patients who are
eventually lost to follow-up.</p>
</div>
<div class="section level2">
<h2 id="analysis">Analysis<a class="anchor" aria-label="anchor" href="#analysis"></a>
</h2>
<p>We now turn to the analysis of this dataset. The population-time
plots above give evidence of non-constant hazard; therefore, we will
explicitly include time in the model. Note that we also include all
other variables as possible confounders. First, we include time as a
linear term:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fitSmoothHazard.html">fitSmoothHazard</a></span><span class="op">(</span><span class="va">Status</span> <span class="op">~</span> <span class="va">ftime</span> <span class="op">+</span> <span class="va">Sex</span> <span class="op">+</span> <span class="va">D</span> <span class="op">+</span> <span class="va">Phase</span> <span class="op">+</span> <span class="va">Source</span> <span class="op">+</span> <span class="va">Age</span>, </span>
<span>                          data <span class="op">=</span> <span class="va">bmtcrr</span>, </span>
<span>                          ratio <span class="op">=</span> <span class="fl">100</span>,</span>
<span>                          time <span class="op">=</span> <span class="st">"ftime"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/CompRisk-class.html">summary</a></span><span class="op">(</span><span class="va">model1</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## fitSmoothHazard(formula = Status ~ ftime + Sex + D + Phase + </span></span>
<span><span class="co">##     Source + Age, data = bmtcrr, time = "ftime", ratio = 100)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients: </span></span>
<span><span class="co">##                 Estimate Std. Error z value Pr(&gt;|z|)    </span></span>
<span><span class="co">## (Intercept):1  -3.527146   0.685168  -5.148 2.63e-07 ***</span></span>
<span><span class="co">## (Intercept):2  -2.648451   0.463012  -5.720 1.06e-08 ***</span></span>
<span><span class="co">## ftime:1        -0.070927   0.014929  -4.751 2.02e-06 ***</span></span>
<span><span class="co">## ftime:2        -0.105177   0.018349  -5.732 9.93e-09 ***</span></span>
<span><span class="co">## SexM:1         -0.289067   0.283217  -1.021 0.307418    </span></span>
<span><span class="co">## SexM:2         -0.382981   0.236935  -1.616 0.106008    </span></span>
<span><span class="co">## DAML:1         -0.575749   0.299617  -1.922 0.054654 .  </span></span>
<span><span class="co">## DAML:2         -0.100149   0.274099  -0.365 0.714833    </span></span>
<span><span class="co">## PhaseCR2:1      0.186766   0.467042   0.400 0.689237    </span></span>
<span><span class="co">## PhaseCR2:2      0.286425   0.332270   0.862 0.388673    </span></span>
<span><span class="co">## PhaseCR3:1      0.586630   0.696521   0.842 0.399660    </span></span>
<span><span class="co">## PhaseCR3:2      0.310781   0.530986   0.585 0.558353    </span></span>
<span><span class="co">## PhaseRelapse:1  1.448907   0.391878   3.697 0.000218 ***</span></span>
<span><span class="co">## PhaseRelapse:2  0.792938   0.307933   2.575 0.010023 *  </span></span>
<span><span class="co">## SourcePB:1      0.456442   0.571108   0.799 0.424162    </span></span>
<span><span class="co">## SourcePB:2     -1.013983   0.355666  -2.851 0.004359 ** </span></span>
<span><span class="co">## Age:1          -0.005242   0.011917  -0.440 0.660007    </span></span>
<span><span class="co">## Age:2           0.028597   0.009929   2.880 0.003976 ** </span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Names of linear predictors: log(mu[,2]/mu[,1]), log(mu[,3]/mu[,1])</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residual deviance: 1409.076 on 26444 degrees of freedom</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Log-likelihood: -704.5378 on 26444 degrees of freedom</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Number of Fisher scoring iterations: 10 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Warning: Hauck-Donner effect detected in the following estimate(s):</span></span>
<span><span class="co">## '(Intercept):1', '(Intercept):2', 'ftime:1', 'ftime:2'</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Reference group is level  1  of the response</span></span></code></pre>
<p>Because of the results in Turgeon <em>et al</em> <span class="citation">(In Preparation)</span>, the standard errors we obtain
from the multinomial logit fit are asymptotically correct, and therefore
can be used to construct asymptotic confidence intervals.</p>
<p>From this summary, we see that time is indeed significant, as is
Phase (only relapse vs. CR1). Interestingly, we see that the type of
disease is only significant for the event of interest, whereas the type
of transplant and the age of the patient are only significant for the
competing event.</p>
<p>Next, we include the logarithm of time in the model (which leads to a
Weibull hazard):</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fitSmoothHazard.html">fitSmoothHazard</a></span><span class="op">(</span><span class="va">Status</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">ftime</span><span class="op">)</span> <span class="op">+</span> <span class="va">Sex</span> <span class="op">+</span> <span class="va">D</span> <span class="op">+</span> <span class="va">Phase</span> <span class="op">+</span> <span class="va">Source</span> <span class="op">+</span> <span class="va">Age</span>, </span>
<span>                          data <span class="op">=</span> <span class="va">bmtcrr</span>, </span>
<span>                          ratio <span class="op">=</span> <span class="fl">100</span>, </span>
<span>                          time <span class="op">=</span> <span class="st">"ftime"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/CompRisk-class.html">summary</a></span><span class="op">(</span><span class="va">model2</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## fitSmoothHazard(formula = Status ~ log(ftime) + Sex + D + Phase + </span></span>
<span><span class="co">##     Source + Age, data = bmtcrr, time = "ftime", ratio = 100)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients: </span></span>
<span><span class="co">##                 Estimate Std. Error z value Pr(&gt;|z|)    </span></span>
<span><span class="co">## (Intercept):1  -3.976762   0.699660  -5.684 1.32e-08 ***</span></span>
<span><span class="co">## (Intercept):2  -3.069308   0.465495  -6.594 4.29e-11 ***</span></span>
<span><span class="co">## log(ftime):1   -0.327063   0.069777  -4.687 2.77e-06 ***</span></span>
<span><span class="co">## log(ftime):2   -0.403220   0.056786  -7.101 1.24e-12 ***</span></span>
<span><span class="co">## SexM:1         -0.413731   0.291497  -1.419  0.15580    </span></span>
<span><span class="co">## SexM:2         -0.521801   0.240157  -2.173  0.02980 *  </span></span>
<span><span class="co">## DAML:1         -0.695303   0.306421  -2.269  0.02326 *  </span></span>
<span><span class="co">## DAML:2         -0.180805   0.287170  -0.630  0.52895    </span></span>
<span><span class="co">## PhaseCR2:1      0.252923   0.468205   0.540  0.58906    </span></span>
<span><span class="co">## PhaseCR2:2      0.365004   0.332952   1.096  0.27296    </span></span>
<span><span class="co">## PhaseCR3:1      0.441402   0.710580   0.621  0.53448    </span></span>
<span><span class="co">## PhaseCR3:2      0.118189   0.535142   0.221  0.82521    </span></span>
<span><span class="co">## PhaseRelapse:1  1.447889   0.394226   3.673  0.00024 ***</span></span>
<span><span class="co">## PhaseRelapse:2  0.821988   0.309721   2.654  0.00796 ** </span></span>
<span><span class="co">## SourcePB:1      0.662955   0.598582   1.108  0.26806    </span></span>
<span><span class="co">## SourcePB:2     -0.920304   0.370576  -2.483  0.01301 *  </span></span>
<span><span class="co">## Age:1          -0.003153   0.011766  -0.268  0.78873    </span></span>
<span><span class="co">## Age:2           0.028695   0.009869   2.908  0.00364 ** </span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Names of linear predictors: log(mu[,2]/mu[,1]), log(mu[,3]/mu[,1])</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residual deviance: 1508.083 on 26444 degrees of freedom</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Log-likelihood: -754.0415 on 26444 degrees of freedom</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Number of Fisher scoring iterations: 8 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Warning: Hauck-Donner effect detected in the following estimate(s):</span></span>
<span><span class="co">## '(Intercept):1', '(Intercept):2'</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Reference group is level  1  of the response</span></span></code></pre>
<p>As we can see, the results are similar to the ones with a Gompertz
hazard, although Sex is now significant for the competing event.</p>
<p>Finally, using splines, we can be quite flexible about the way the
hazard depends on time:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fitSmoothHazard.html">fitSmoothHazard</a></span><span class="op">(</span></span>
<span>    <span class="va">Status</span> <span class="op">~</span> <span class="fu">splines</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/splines/bs.html" class="external-link">bs</a></span><span class="op">(</span><span class="va">ftime</span><span class="op">)</span> <span class="op">+</span> <span class="va">Sex</span> <span class="op">+</span> <span class="va">D</span> <span class="op">+</span> <span class="va">Phase</span> <span class="op">+</span> <span class="va">Source</span> <span class="op">+</span> <span class="va">Age</span>, </span>
<span>    data <span class="op">=</span> <span class="va">bmtcrr</span>, </span>
<span>    ratio <span class="op">=</span> <span class="fl">100</span>, </span>
<span>    time <span class="op">=</span> <span class="st">"ftime"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/CompRisk-class.html">summary</a></span><span class="op">(</span><span class="va">model3</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## fitSmoothHazard(formula = Status ~ splines::bs(ftime) + Sex + </span></span>
<span><span class="co">##     D + Phase + Source + Age, data = bmtcrr, time = "ftime", </span></span>
<span><span class="co">##     ratio = 100)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients: </span></span>
<span><span class="co">##                         Estimate Std. Error z value Pr(&gt;|z|)    </span></span>
<span><span class="co">## (Intercept):1          -3.714285   0.697993  -5.321 1.03e-07 ***</span></span>
<span><span class="co">## (Intercept):2          -3.168984   0.498239  -6.360 2.01e-10 ***</span></span>
<span><span class="co">## splines::bs(ftime)1:1  -0.212237   2.256878  -0.094 0.925077    </span></span>
<span><span class="co">## splines::bs(ftime)1:2   6.902278   3.669973   1.881 0.060007 .  </span></span>
<span><span class="co">## splines::bs(ftime)2:1 -15.567038   8.068389      NA       NA    </span></span>
<span><span class="co">## splines::bs(ftime)2:2 -76.712396  25.661616      NA       NA    </span></span>
<span><span class="co">## splines::bs(ftime)3:1  -2.723383  10.472710      NA       NA    </span></span>
<span><span class="co">## splines::bs(ftime)3:2  -2.864418  22.204096      NA       NA    </span></span>
<span><span class="co">## SexM:1                 -0.283588   0.282655  -1.003 0.315715    </span></span>
<span><span class="co">## SexM:2                 -0.420961   0.236815  -1.778 0.075470 .  </span></span>
<span><span class="co">## DAML:1                 -0.623451   0.301696  -2.066 0.038782 *  </span></span>
<span><span class="co">## DAML:2                 -0.127162   0.275996  -0.461 0.644985    </span></span>
<span><span class="co">## PhaseCR2:1              0.120167   0.464896   0.258 0.796035    </span></span>
<span><span class="co">## PhaseCR2:2              0.215708   0.330313   0.653 0.513729    </span></span>
<span><span class="co">## PhaseCR3:1              0.494530   0.692452   0.714 0.475121    </span></span>
<span><span class="co">## PhaseCR3:2              0.228801   0.525830   0.435 0.663473    </span></span>
<span><span class="co">## PhaseRelapse:1          1.451148   0.392110   3.701 0.000215 ***</span></span>
<span><span class="co">## PhaseRelapse:2          0.821627   0.310515   2.646 0.008145 ** </span></span>
<span><span class="co">## SourcePB:1              0.444775   0.571636   0.778 0.436526    </span></span>
<span><span class="co">## SourcePB:2             -1.127417   0.358987  -3.141 0.001686 ** </span></span>
<span><span class="co">## Age:1                  -0.005600   0.011888  -0.471 0.637619    </span></span>
<span><span class="co">## Age:2                   0.028070   0.009914   2.831 0.004634 ** </span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Names of linear predictors: log(mu[,2]/mu[,1]), log(mu[,3]/mu[,1])</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residual deviance: 1402.024 on 26440 degrees of freedom</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Log-likelihood: -701.0122 on 26440 degrees of freedom</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Number of Fisher scoring iterations: 16 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Warning: Hauck-Donner effect detected in the following estimate(s):</span></span>
<span><span class="co">## '(Intercept):1', '(Intercept):2', 'splines::bs(ftime)2:1', 'splines::bs(ftime)2:2', 'splines::bs(ftime)3:1', 'splines::bs(ftime)3:2'</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Reference group is level  1  of the response</span></span></code></pre>
<p>Again, we see that the results are quite similar for this third
model.</p>
<div class="section level3">
<h3 id="absolute-risk">Absolute risk<a class="anchor" aria-label="anchor" href="#absolute-risk"></a>
</h3>
<p>We now look at the 2-year risk of relapse:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">linearRisk</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/absoluteRisk.html">absoluteRisk</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">model1</span>, time <span class="op">=</span> <span class="fl">24</span>, newdata <span class="op">=</span> <span class="va">bmtcrr</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>,<span class="op">]</span><span class="op">)</span></span>
<span><span class="va">logRisk</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/absoluteRisk.html">absoluteRisk</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">model2</span>, time <span class="op">=</span> <span class="fl">24</span>, newdata <span class="op">=</span> <span class="va">bmtcrr</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>,<span class="op">]</span><span class="op">)</span></span>
<span><span class="va">splineRisk</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/absoluteRisk.html">absoluteRisk</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">model3</span>, time <span class="op">=</span> <span class="fl">24</span>, newdata <span class="op">=</span> <span class="va">bmtcrr</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>,<span class="op">]</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">linearRisk</span>, <span class="va">logRisk</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"Linear"</span>, ylab <span class="op">=</span> <span class="st">"Log/Spline"</span>, pch <span class="op">=</span> <span class="fl">19</span>,</span>
<span>     xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">'red'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">linearRisk</span>, <span class="va">splineRisk</span>,</span>
<span>       col <span class="op">=</span> <span class="st">'blue'</span>, pch <span class="op">=</span> <span class="fl">19</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>a <span class="op">=</span> <span class="fl">0</span>, b <span class="op">=</span> <span class="fl">1</span>, lty <span class="op">=</span> <span class="fl">2</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topleft"</span>, legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Log"</span>, <span class="st">"Spline"</span><span class="op">)</span>,</span>
<span>       pch <span class="op">=</span> <span class="fl">19</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"red"</span>, <span class="st">"blue"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="competingRisk_files/figure-html/absRiskPlot-1.png" width="700"></p>
</div>
</div>
<div class="section level2">
<h2 id="session-information">Session information<a class="anchor" aria-label="anchor" href="#session-information"></a>
</h2>
<pre><code><span><span class="co">## R version 4.3.3 (2024-02-29)</span></span>
<span><span class="co">## Platform: x86_64-pc-linux-gnu (64-bit)</span></span>
<span><span class="co">## Running under: Ubuntu 22.04.4 LTS</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Matrix products: default</span></span>
<span><span class="co">## BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 </span></span>
<span><span class="co">## LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.20.so;  LAPACK version 3.10.0</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## attached base packages:</span></span>
<span><span class="co">## [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## other attached packages:</span></span>
<span><span class="co">## [1] casebase_0.10.5</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## loaded via a namespace (and not attached):</span></span>
<span><span class="co">##  [1] Matrix_1.6-5      gtable_0.3.4      jsonlite_1.8.8    highr_0.10       </span></span>
<span><span class="co">##  [5] dplyr_1.1.4       compiler_4.3.3    tidyselect_1.2.1  VGAM_1.1-10      </span></span>
<span><span class="co">##  [9] jquerylib_0.1.4   splines_4.3.3     systemfonts_1.0.6 scales_1.3.0     </span></span>
<span><span class="co">## [13] textshaping_0.3.7 yaml_2.3.8        fastmap_1.1.1     lattice_0.22-5   </span></span>
<span><span class="co">## [17] ggplot2_3.5.0     R6_2.5.1          generics_0.1.3    knitr_1.46       </span></span>
<span><span class="co">## [21] tibble_3.2.1      desc_1.4.3        munsell_0.5.1     bslib_0.7.0      </span></span>
<span><span class="co">## [25] pillar_1.9.0      rlang_1.1.3       utf8_1.2.4        cachem_1.0.8     </span></span>
<span><span class="co">## [29] xfun_0.43         fs_1.6.3          sass_0.4.9        memoise_2.0.1    </span></span>
<span><span class="co">## [33] cli_3.6.2         mgcv_1.9-1        pkgdown_2.0.7     magrittr_2.0.3   </span></span>
<span><span class="co">## [37] digest_0.6.35     grid_4.3.3        nlme_3.1-164      lifecycle_1.0.4  </span></span>
<span><span class="co">## [41] vctrs_0.6.5       evaluate_0.23     glue_1.7.0        data.table_1.15.4</span></span>
<span><span class="co">## [45] ragg_1.3.0        survival_3.5-8    stats4_4.3.3      fansi_1.0.6      </span></span>
<span><span class="co">## [49] colorspace_2.1-0  rmarkdown_2.26    purrr_1.0.2       pkgconfig_2.0.3  </span></span>
<span><span class="co">## [53] tools_4.3.3       htmltools_0.5.8.1</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<ol>
<li>
<p>
Efron, Bradley. 1977. “The Efficiency of Cox’s Likelihood Function for
Censored Data.” <em>Journal of the American Statistical Association</em>
72 (359). Taylor &amp; Francis Group: 557–65.
</p>
</li>
<li>
<p>
Hanley, James A, and Olli S Miettinen. 2009. “Fitting Smooth-in-Time
Prognostic Risk Functions via Logistic Regression.” <em>The
International Journal of Biostatistics</em> 5 (1).
</p>
</li>
<li>
<p>
Mantel, Nathan. 1973. “Synthetic Retrospective Studies and Related
Topics.” <em>Biometrics</em>. JSTOR, 479–86.
</p>
</li>
<li>
<p>
Saarela, Olli. 2015. “A Case-Base Sampling Method for Estimating
Recurrent Event Intensities.” <em>Lifetime Data Analysis</em>. Springer,
1–17.
</p>
</li>
<li>
<p>
Saarela, Olli, and Elja Arjas. 2015. “Non-Parametric Bayesian Hazard
Regression for Chronic Disease Risk Assessment.” <em>Scandinavian
Journal of Statistics</em> 42 (2). Wiley Online Library: 609–26.
</p>
</li>
<li>
<p>
Scrucca, L, A Santucci, and F Aversa. 2010. “Regression Modeling of
Competing Risk Using R: An in Depth Guide for Clinicians.” <em>Bone
Marrow Transplantation</em> 45 (9). Nature Publishing Group: 1388–95.
</p>
</li>
<li>
<p>
Kalbfleisch, John D., and Ross L. Prentice. The statistical analysis of
failure time data. Vol. 360. John Wiley &amp; Sons, 2011.
</p>
</li>
<li>
<p>
Cox, D. R. “Regression models and life tables.” <em>Journal of the Royal
Statistical Society</em> 34 (1972): 187-220.
</p>
</li>
</ol>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-scrucca2010regression" class="csl-entry">
Scrucca, L., A. Santucci, and F. Aversa. 2010. <span>“Regression
Modeling of Competing Risk Using r: An in Depth Guide for
Clinicians.”</span> <em>Bone Marrow Transplantation</em> 45 (9):
1388–95.
</div>
<div id="ref-turgeonCompRisk" class="csl-entry">
Turgeon, M., S. Bhatnagar, and O. Saarela. In Preparation. <span>“A
Novel Approach to Competing Risk Analysis Using Case-Base
Sampling.”</span>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by <a href="https://sahirbhatnagar.com/" class="external-link">Sahir Bhatnagar</a>, <a href="https://maxturgeon.ca/" class="external-link">Maxime Turgeon</a>, <a href="https://www.jesseislam.com/" class="external-link">Jesse Islam</a>, <a href="http://individual.utoronto.ca/osaarela/" class="external-link">Olli Saarela</a>, <a href="http://www.medicine.mcgill.ca/epidemiology/hanley/" class="external-link">James Hanley</a>.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
